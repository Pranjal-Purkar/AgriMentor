<div *ngIf="isLoading" class="flex justify-center p-8">
  <div class="relative">
    <div
      class="w-12 h-12 border-4 border-emerald-200 border-t-emerald-600 rounded-full animate-spin"
    ></div>
    <div
      class="absolute inset-0 w-12 h-12 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin"
      style="animation-duration: 1.5s"
    ></div>
  </div>
</div>

<div
  *ngIf="!isLoading && !feedback"
  class="relative overflow-hidden text-center py-12 px-6 bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl border-2 border-dashed border-gray-200 group hover:border-gray-300 transition-all duration-300"
>
  <div
    class="absolute inset-0 bg-gradient-to-br from-emerald-50/30 to-purple-50/30 opacity-0 group-hover:opacity-100 transition-opacity duration-500"
  ></div>
  <div class="relative">
    <div
      class="w-16 h-16 mx-auto mb-4 bg-gradient-to-br from-gray-200 to-gray-300 rounded-full flex items-center justify-center"
    >
      <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"
        ></path>
      </svg>
    </div>
    <p class="text-gray-600 font-medium">No feedback provided yet.</p>
    <p class="text-gray-400 text-sm mt-1">Feedback will appear here once submitted.</p>
  </div>
</div>

<div
  *ngIf="!isLoading && feedback"
  class="relative overflow-hidden bg-gradient-to-br from-white via-purple-50/20 to-emerald-50/30 rounded-3xl shadow-xl border border-gray-100/50 backdrop-blur-sm animate-fadeIn"
>
  <!-- Decorative gradient overlay -->
  <div
    class="absolute inset-0 bg-gradient-to-br from-emerald-500/5 via-transparent to-purple-500/5 pointer-events-none"
  ></div>

  <!-- Animated background pattern -->
  <div
    class="absolute inset-0 opacity-[0.02]"
    style="
      background-image: radial-gradient(circle at 2px 2px, currentColor 1px, transparent 0);
      background-size: 32px 32px;
    "
  ></div>

  <div class="relative p-8">
    <!-- Header -->
    <div class="flex items-start justify-between mb-8 pb-6 border-b border-gray-200/50">
      <div class="flex gap-5">
        <div class="shrink-0 relative group">
          <div
            class="absolute inset-0 bg-gradient-to-br from-purple-400 to-indigo-500 rounded-2xl blur-lg opacity-30 group-hover:opacity-50 transition-opacity duration-300"
          ></div>
          <div
            class="relative w-16 h-16 bg-gradient-to-br from-purple-100 via-indigo-100 to-purple-200 text-indigo-700 rounded-2xl flex items-center justify-center font-bold text-2xl shadow-lg ring-4 ring-white transform group-hover:scale-105 transition-transform duration-300"
          >
            {{ feedback.farmerName?.charAt(0) || '?' }}
          </div>
        </div>
        <div>
          <h3 class="text-xl font-bold text-gray-900 mb-1">{{ feedback.farmerName }}</h3>
          <div class="flex items-center gap-2 text-sm text-gray-500">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
              ></path>
            </svg>
            <span>{{ feedback.createdAt | date : 'mediumDate' }}</span>
          </div>
        </div>
      </div>

      <div class="shrink-0">
        <div
          class="relative flex items-center gap-2 bg-gradient-to-br from-yellow-50 to-amber-50 px-5 py-2.5 rounded-2xl border border-yellow-200/50 shadow-sm hover:shadow-md transition-all duration-300 group"
        >
          <div
            class="absolute inset-0 bg-gradient-to-br from-yellow-400/10 to-amber-400/10 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"
          ></div>
          <span class="relative text-lg font-bold text-yellow-700">{{
            feedback.ratingOverall | number : '1.1-1'
          }}</span>
          <svg
            class="relative w-5 h-5 text-yellow-500 fill-current animate-pulse"
            viewBox="0 0 24 24"
          >
            <path
              d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"
            />
          </svg>
        </div>
      </div>
    </div>

    <!-- Detailed Ratings -->
    <div class="mb-8">
      <h4 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-4">
        Rating Breakdown
      </h4>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <!-- Communication Rating -->
        <div
          class="group relative overflow-hidden bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl p-5 border border-blue-100/50 hover:shadow-lg hover:scale-[1.02] transition-all duration-300"
        >
          <div
            class="absolute inset-0 bg-gradient-to-br from-blue-400/10 to-cyan-400/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"
          ></div>
          <div class="relative">
            <div class="flex items-center gap-2 mb-3">
              <svg
                class="w-5 h-5 text-blue-500"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
                ></path>
              </svg>
              <p class="text-xs font-bold text-blue-700 uppercase tracking-wider">Communication</p>
            </div>
            <div class="flex gap-1">
              <span
                *ngFor="let s of stars"
                class="text-2xl transition-all duration-200 hover:scale-125 cursor-default"
                [class.text-yellow-400]="s <= feedback.ratingCommunication"
                [class.text-gray-300]="s > feedback.ratingCommunication"
                >★</span
              >
            </div>
          </div>
        </div>

        <!-- Expertise Rating -->
        <div
          class="group relative overflow-hidden bg-gradient-to-br from-emerald-50 to-teal-50 rounded-2xl p-5 border border-emerald-100/50 hover:shadow-lg hover:scale-[1.02] transition-all duration-300"
        >
          <div
            class="absolute inset-0 bg-gradient-to-br from-emerald-400/10 to-teal-400/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"
          ></div>
          <div class="relative">
            <div class="flex items-center gap-2 mb-3">
              <svg
                class="w-5 h-5 text-emerald-500"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
                ></path>
              </svg>
              <p class="text-xs font-bold text-emerald-700 uppercase tracking-wider">Expertise</p>
            </div>
            <div class="flex gap-1">
              <span
                *ngFor="let s of stars"
                class="text-2xl transition-all duration-200 hover:scale-125 cursor-default"
                [class.text-yellow-400]="s <= feedback.ratingExpertise"
                [class.text-gray-300]="s > feedback.ratingExpertise"
                >★</span
              >
            </div>
          </div>
        </div>

        <!-- Timeliness Rating -->
        <div
          class="group relative overflow-hidden bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-5 border border-purple-100/50 hover:shadow-lg hover:scale-[1.02] transition-all duration-300"
        >
          <div
            class="absolute inset-0 bg-gradient-to-br from-purple-400/10 to-pink-400/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"
          ></div>
          <div class="relative">
            <div class="flex items-center gap-2 mb-3">
              <svg
                class="w-5 h-5 text-purple-500"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                ></path>
              </svg>
              <p class="text-xs font-bold text-purple-700 uppercase tracking-wider">Timeliness</p>
            </div>
            <div class="flex gap-1">
              <span
                *ngFor="let s of stars"
                class="text-2xl transition-all duration-200 hover:scale-125 cursor-default"
                [class.text-yellow-400]="s <= feedback.ratingTimeliness"
                [class.text-gray-300]="s > feedback.ratingTimeliness"
                >★</span
              >
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Feedback Content -->
    <div class="relative">
      <h4 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-3">
        Feedback Comments
      </h4>
      <div
        class="relative overflow-hidden bg-gradient-to-br from-gray-50 to-gray-100/50 rounded-2xl p-6 border border-gray-200/50 group hover:shadow-md transition-all duration-300"
      >
        <div
          class="absolute inset-0 bg-gradient-to-br from-emerald-500/5 to-purple-500/5 opacity-0 group-hover:opacity-100 transition-opacity duration-500"
        ></div>
        <div class="relative">
          <svg
            class="absolute -top-2 -left-2 w-8 h-8 text-gray-300/50"
            fill="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h3.983v10h-9.983z"
            />
          </svg>
          <p class="text-gray-700 leading-relaxed pl-6 pt-2">{{ feedback.feedbackText }}</p>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fadeIn {
    animation: fadeIn 0.5s ease-out;
  }
</style>
