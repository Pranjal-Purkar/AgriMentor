<div 
  class="w-full mx-auto mt-8 bg-white/60 backdrop-blur-xl shadow-2xl rounded-3xl p-10 border border-white/40"
  data-aos="fade-up"
  data-aos-duration="800"
>

  <!-- HEADER -->
  <div class="flex items-center justify-between mb-10">
   

    <button
      (click)="toggleEdit()"
      class="px-6 py-2.5 rounded-xl font-medium shadow-lg transition-all duration-300"
      [ngClass]="editMode 
        ? 'bg-gray-700 text-white hover:bg-gray-800' 
        : 'bg-gradient-to-r from-green-600 to-emerald-600 text-white hover:from-green-700 hover:to-emerald-700'"
      data-aos="fade-left"
      data-aos-delay="200"
    >
      {{ editMode ? 'Cancel' : 'Edit Profile' }}
    </button>
  </div>

  <!-- PROFILE PHOTO -->
  <div class="flex justify-center mb-12" data-aos="zoom-in" data-aos-delay="200">
    <div class="relative group">
      <img
        [src]="profilePreview || farmerProfile?.photo || 'assets/default-profile.png'"
        class="w-40 h-40 rounded-full object-cover border-4 border-white shadow-xl transition-all duration-300 group-hover:scale-105"
      />

      @if (editMode) {
        <label class="absolute bottom-2 right-2 bg-white p-2 rounded-full shadow-lg cursor-pointer hover:scale-110 transition-transform">
          <input type="file" (change)="onPhotoSelect($event)" class="hidden" />
          <svg class="w-6 h-6 text-green-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1M12 12v9m0 0l3-3m-3 3l-3-3"/>
          </svg>
        </label>
      }
    </div>
  </div>

  <!-- VIEW MODE -->
  @if (!editMode) {

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

      @for (field of [
        { label: 'First Name', value: farmerProfile?.firstName },
        { label: 'Last Name', value: farmerProfile?.lastName },
        { label: 'Email', value: farmerProfile?.email },
        { label: 'Phone', value: farmerProfile?.phone },
        { label: 'Location', value: farmerProfile?.location },
        { label: 'Soil Type', value: farmerProfile?.soilType },
        { label: 'Farm Size (acres)', value: farmerProfile?.farmSize },
      ]; track field.label) {
        <div 
          class="bg-white/70 border border-gray-200 rounded-xl p-5 shadow hover:shadow-md transition-all duration-300"
          data-aos="fade-up"
          data-aos-duration="600"
        >
          <p class="text-sm text-gray-500">{{ field.label }}</p>
          <p class="font-semibold text-gray-900 text-lg mt-1">{{ field.value }}</p>
        </div>
      }

      <!-- Primary Crops -->
      <div 
        class="md:col-span-2 bg-white/70 border border-gray-200 rounded-xl p-5 shadow hover:shadow-md transition-all duration-300"
        data-aos="fade-up"
        data-aos-duration="600"
      >
        <p class="text-sm text-gray-500">Primary Crops</p>
        <p class="font-semibold text-gray-900 text-lg mt-1">{{ farmerProfile?.primaryCrops }}</p>
      </div>

    </div>

  }

  <!-- EDIT MODE -->
  @else {

    <form 
      [formGroup]="profileForm" 
      class="grid grid-cols-1 md:grid-cols-2 gap-8"
      data-aos="fade-up"
      data-aos-duration="700"
    >

      @for(field of [
        { key:'firstName', label:'First Name' },
        { key:'lastName', label:'Last Name' },
        { key:'email', label:'Email', disabled:true },
        { key:'phone', label:'Phone' },
        { key:'location', label:'Location' },
        { key:'soilType', label:'Soil Type' },
        { key:'farmSize', label:'Farm Size (acres)', type:'number' }
      ]; track field.key) {

        <div>
          <label class="text-sm text-gray-600">{{ field.label }}</label>
          <input
  [formControlName]="field.key"
  [type]="field.type || 'text'"
  [disabled]="field.disabled ?? false"
  class="w-full mt-1 border border-gray-300 px-4 py-2.5 rounded-xl bg-white 
         focus:ring-2 focus:ring-green-500 shadow-sm transition-all"
/>
        </div>

      }

      <div class="md:col-span-2">
        <label class="text-sm text-gray-600">Primary Crops</label>
        <input formControlName="primaryCrops"
          class="w-full mt-1 border border-gray-300 px-4 py-2.5 rounded-xl bg-white focus:ring-2 focus:ring-green-500 shadow-sm transition-all" />
      </div>

      <!-- SAVE BUTTON -->
      <div class="md:col-span-2">
        <button
          (click)="saveChanges()"
          class="w-full mt-6 bg-gradient-to-r from-green-600 to-emerald-600 text-white py-3 
                 rounded-xl shadow-lg hover:from-green-700 hover:to-emerald-800 transition-all 
                 duration-300 hover:-translate-y-0.5"
          data-aos="zoom-in"
        >
          Save Changes
        </button>
      </div>

    </form>

  }

</div>
